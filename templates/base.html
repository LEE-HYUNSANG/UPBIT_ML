<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}AUTO UPBIT{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">
<header class="bg-gray-950 border-b border-gray-700">
    <div class="max-w-6xl mx-auto flex items-center justify-between p-4">
        <nav class="flex gap-6 font-semibold">
            <a href="{{ url_for('dashboard') }}" class="hover:text-green-400">대시보드</a>
            <a href="{{ url_for('settings') }}" class="hover:text-green-400">알림 설정</a>
        </nav>
        <div class="flex items-center gap-3">
            <span id="server-status" class="text-sm text-red-500 font-bold">오프라인</span>
            <label class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="autotrade-toggle" class="sr-only peer" onchange="toggleAutoTrade(this)">
                <div class="w-11 h-6 bg-gray-600 rounded-full peer peer-checked:bg-green-500 transition"></div>
                <span class="absolute left-1 top-0.5 w-5 h-5 bg-white rounded-full peer-checked:translate-x-full transition"></span>
            </label>
        </div>
    </div>
</header>
<main class="max-w-6xl mx-auto p-4">
    {% block content %}{% endblock %}
</main>
<script>
function toggleAutoTrade(cb){
    fetch('/api/auto_trade_status', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({enabled: cb.checked})
    }).catch(() => cb.checked = !cb.checked);
}
function fetchStatus(){
    fetch('/api/auto_trade_status')
        .then(r => r.json())
        .then(d => {
            const status = document.getElementById('server-status');
            const cb = document.getElementById('autotrade-toggle');
            if(cb) cb.checked = d.enabled;
            if(status) status.textContent = d.enabled ? '연동중' : '오프라인';
        });
}
fetchStatus();
setInterval(fetchStatus, 5000);
</script>
{% block scripts %}{% endblock %}
</body>
</html>
